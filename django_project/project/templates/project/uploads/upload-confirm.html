
<h2>Confirm Upload</h2>

{% if conflicts %}
  <p style="color: red;">⚠️ Conflicting <strong>source_id</strong>s found: {{ conflicts }}</p>
  <p>Do you want to overwrite existing records?</p>
{% else %}
  <p style="color: green;">✅ No ID conflicts detected. You may upload safely.</p>
{% endif %}

<h3>Preview (first 5 rows):</h3>
<table border="1">
  <tr>
    {% for key in preview.0.keys %}
      <th>{{ key }}</th>
    {% endfor %}
  </tr>
  {% for row in preview %}
    <tr>
      {% for val in row.values %}
        <td>{{ val }}</td>
      {% endfor %}
    </tr>
  {% endfor %}
</table>

<form method="post">
  {% csrf_token %}
  <input type="hidden" name="confirm_upload" value="1">
  <input type="hidden" name="overwrite" value="{% if overwrite %}true{% else %}false{% endif %}">
  <button type="submit">Yes, Upload</button>
  <a href="{% url 'upload_catalog' %}">Cancel</a>
</form>
